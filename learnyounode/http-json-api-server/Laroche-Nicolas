const port = process.argv[2];
const http = require('http');
const url = require('url');

const server = http.createServer(function (request, response) {
  if (request.method !== 'GET') {
    response.writeHead(405);
    return;
  }
  const urlParse = url.parse(request.url, true);
  response.writeHead(200, {'Content-Type': 'application/json'})
  const params = urlParse.query.iso;
  if (urlParse.pathname === '/api/parsetime') {
    const date = new Date(params);
    response.end(JSON.stringify({
      hour: date.getHours(),
      minute: date.getMinutes(),
      second: date.getSeconds()
    }));
  } else if (urlParse.pathname === '/api/unixtime') {
    const date = new Date(params);
    response.end(JSON.stringify({
        unixtime: date.getTime()
      }
    ));
  } else {
    response.writeHead(404);
  }
});
server.listen(port);
